(this["webpackJsonpdiscord-clone"]=this["webpackJsonpdiscord-clone"]||[]).push([[0],{87:function(e,c,n){},88:function(e,c,n){"use strict";n.r(c);var a=n(2),t=n.n(a),s=n(15),i=n.n(s),r=n(27),o=n(59),l=n.n(o),j=n(71),d=n.n(j),u=n(42),h=n.n(u),b=n(57),m=n(129),p=n(111),O=n(20),f=n(31),x=Object(f.b)({name:"app",initialState:{channelId:null,channelName:null},reducers:{setChannelInfo:function(e,c){e.channelId=c.payload.channelId,e.channelName=c.payload.channelName}}}),g=x.actions.setChannelInfo,_=function(e){return e.app.channelId},v=function(e){return e.app.channelName},N=x.reducer,S=n(70),w=n.n(S),I=n(130),y=n(35),C=y.a.initializeApp({apiKey:"AIzaSyAKpwgc67ePNVC8IqaiGvSAonsB5xYII3I",authDomain:"discord-clone-72cf6.firebaseapp.com",projectId:"discord-clone-72cf6",storageBucket:"discord-clone-72cf6.appspot.com",messagingSenderId:"895733720231",appId:"1:895733720231:web:ce372aca78630dfa596782",measurementId:"G-BRS8JSFNQ8"}).firestore(),k=y.a.auth(),B=new y.a.auth.GoogleAuthProvider,T=C,z=n(4),A=function(e){var c=e.id,n=e.channelName,t=Object(O.b)(),s=Object(a.useState)(!1),i=Object(r.a)(s,2),o=i[0],l=i[1],j=Object(a.useState)(n),d=Object(r.a)(j,2),u=d[0],f=d[1],x=function(){var e=Object(b.a)(h.a.mark((function e(n){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n||(n=window.event),n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation(),console.log("save object"),a=T.collection("channels").doc(c),e.next=7,a.set({channelName:u});case 7:return e.prev=7,e.next=10,T.runTransaction(function(){var e=Object(b.a)(h.a.mark((function e(c){var n,t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(a);case 2:n=e.sent,t=n.data().population+1,c.update(a,{population:t});case 5:case"end":return e.stop()}}),e)})));return function(c){return e.apply(this,arguments)}}());case 10:console.log("Transaction success!"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),console.log("Transaction failure:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(c){return e.apply(this,arguments)}}();return o?Object(z.jsxs)("div",{className:"sidebarChannel",children:[Object(z.jsx)(I.a,{value:u,onChange:function(e){return f(e.currentTarget.value)}}),":",Object(z.jsx)(m.a,{title:"Save",children:Object(z.jsx)(w.a,{onClick:function(e){return x(e)}})})]}):Object(z.jsxs)("div",{onClick:function(){return t(g({channelId:c,channelName:n}))},className:"sidebarChannel",children:[Object(z.jsxs)("h4",{children:[Object(z.jsx)("span",{className:"sidebarChannel__hash",children:"#"}),n]}),Object(z.jsx)(m.a,{title:"Edit",children:Object(z.jsx)(p.a,{onClick:function(e){if(!e)e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),console.log("edit object"),l(!0)}})})]})},E=n(112),P=n(113),H=n(114),D=n(115),F=n(116),G=n(117),J=n(132),U=Object(f.b)({name:"user",initialState:{user:null},reducers:{login:function(e,c){e.user=c.payload},logout:function(e){e.user=null}}}),V=U.actions,W=V.login,K=V.logout,L=function(e){return e.user.user},M=U.reducer,R=function(){var e=Object(O.c)(L),c=Object(a.useState)([]),n=Object(r.a)(c,2),t=n[0],s=n[1];Object(a.useEffect)((function(){T.collection("channels").onSnapshot((function(e){s(e.docs.map((function(e){return{id:e.id,channel:e.data()}})))}))}),[]);return Object(z.jsxs)("div",{className:"sidebar",children:[Object(z.jsxs)("div",{className:"sidebar__top",children:[Object(z.jsx)("h3",{children:"Clever programmer "}),Object(z.jsx)(l.a,{})]}),Object(z.jsxs)("div",{className:"sidebar__channels",children:[Object(z.jsxs)("div",{className:"sidebar__channelHeader",children:[Object(z.jsxs)("div",{className:"sidebar__header",children:[Object(z.jsx)(l.a,{}),Object(z.jsx)("h4",{children:"text channel"})]}),Object(z.jsx)(d.a,{onClick:function(){var e=prompt("Enter a new channel name :");e&&T.collection("channels").add({channelName:e})},className:"sidebar__addChannel"})]}),Object(z.jsx)("div",{className:"sidebar__channelsList",children:t.map((function(e){var c=e.id,n=e.channel;return Object(z.jsx)(A,{id:c,channelName:n.channelName},c)}))})]}),Object(z.jsxs)("div",{className:"sidebar__voice",children:[Object(z.jsx)(E.a,{className:"sidebar__voice__icon",fontSize:"large"}),Object(z.jsxs)("div",{className:"sidebar__voice__info",children:[Object(z.jsx)("h3",{children:"Voice connected"}),Object(z.jsx)("p",{children:"Stream"})]}),Object(z.jsxs)("div",{className:"sidebar__voice__icons",children:[Object(z.jsx)(P.a,{}),Object(z.jsx)(H.a,{})]})]}),Object(z.jsxs)("div",{className:"sidebar__profile",children:[Object(z.jsx)(J.a,{src:e.photo}),Object(z.jsxs)("div",{className:"sidebar__profile__info",children:[Object(z.jsx)("h3",{children:e.displayName}),Object(z.jsx)("p",{children:e.uid})]}),Object(z.jsxs)("div",{className:"sidebar__profile__icons",children:[Object(z.jsx)(D.a,{}),Object(z.jsx)(F.a,{}),Object(z.jsx)(G.a,{titleAccess:"logout",style:{cursor:"pointer"},onClick:function(){return k.signOut()}})]})]})]})},q=n(124),Q=n(125),Y=n(126),$=n(127),X=n(118),Z=n(119),ee=n(120),ce=n(121),ne=n(122),ae=n(123),te=function(e){var c=e.channelName;return Object(z.jsxs)("div",{className:"chatHeader",children:[Object(z.jsx)("div",{className:"chatHeader__left",children:Object(z.jsxs)("h3",{children:[Object(z.jsx)("span",{className:"chatHeader__left__hash",children:"#"}),c]})}),Object(z.jsxs)("div",{className:"chatHeader__right",children:[Object(z.jsx)(X.a,{}),Object(z.jsx)(Z.a,{}),Object(z.jsx)(ee.a,{}),Object(z.jsxs)("div",{className:"chatHeader__right__search",children:[Object(z.jsx)("input",{placeholder:"search"}),Object(z.jsx)(ce.a,{})]}),Object(z.jsx)(ne.a,{}),Object(z.jsx)(ae.a,{})]})]})},se=function(e){var c=e.message,n=e.user,a=e.timestamp;return Object(z.jsxs)("div",{className:"message",children:[Object(z.jsx)(J.a,{src:n.photo}),Object(z.jsxs)("div",{className:"message__info",children:[Object(z.jsxs)("h4",{children:[n.displayName,Object(z.jsx)("span",{className:"message__info__timestamp",children:new Date(null===a||void 0===a?void 0:a.toDate()).toUTCString()})]}),Object(z.jsx)("p",{children:c})]})]})},ie=function(){var e=Object(O.c)(L);console.log("user",e);var c=Object(O.c)(v),n=Object(O.c)(_),t=Object(a.useState)(""),s=Object(r.a)(t,2),i=s[0],o=s[1],l=Object(a.useState)([]),j=Object(r.a)(l,2),d=j[0],u=j[1];console.log("messages",d),console.log("channelId",n),Object(a.useEffect)((function(){n&&(console.log("useEffect"),T.collection("channels").doc(n).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return console.log("snapshot",e),u(e.docs.map((function(e){return e.data()})))})))}),[n]);return Object(z.jsxs)("div",{className:"chat",children:[Object(z.jsx)(te,{channelName:c}),Object(z.jsx)("div",{className:"chat__messages",children:d.map((function(e){return Object(z.jsx)(se,{timestamp:e.timestamp,user:e.user,message:e.message})}))}),Object(z.jsxs)("div",{className:"chat__input",children:[Object(z.jsx)(q.a,{fontSize:"larger"}),Object(z.jsxs)("form",{className:"chat__input__form",children:[Object(z.jsx)("input",{value:i,onChange:function(e){return o(e.target.value)},placeholder:"Message  #".concat(c||"")}),Object(z.jsx)("button",{onClick:function(c){c.preventDefault(),T.collection("channels").doc(n).collection("messages").add({message:i,user:e,timestamp:y.a.firestore.FieldValue.serverTimestamp()}),o("")},className:"chat__inputButton",type:"submit",children:"Send message"})]}),Object(z.jsxs)("div",{className:"chat__inputIcons",children:[Object(z.jsx)(Q.a,{fontSize:"larger"}),Object(z.jsx)(Y.a,{fontSize:"larger"}),Object(z.jsx)($.a,{fontSize:"larger"})]})]})]})},re=n(131),oe=function(){var e=Object(O.b)();return Object(a.useEffect)((function(){k.onAuthStateChanged((function(c){console.log("authUser",c),e(c?W({uid:c.id||"",photo:c.photoURL,email:c.email,displayName:c.displayName}):K())}))}),[e]),Object(z.jsxs)("div",{className:"login",children:[Object(z.jsx)("div",{className:"login__logo",children:Object(z.jsx)("img",{src:"https://1000logos.net/wp-content/uploads/2020/10/Discord-logo.png",alt:"discord_logo"})}),Object(z.jsx)(re.a,{className:"login__button",onClick:function(){k.signInWithPopup(B).catch((function(e){return console.log("err",e)}))},children:"Sign in"})]})},le=n(72),je=n(128);var de=function(){var e=Object(O.c)(L),c=Object(le.a)();return console.log("theme",c),c.palette.primary={light:"#757ce8",main:"#808080",dark:"#808080",contrastText:"#ffffff"},c.palette.secondary={light:"#ff7961",main:"#f44336",dark:"#ba000d",contrastText:"#ffffff"},c.palette.text.primary="rgb(128,128,128)",Object(z.jsx)(je.a,{theme:c,children:Object(z.jsx)("div",{className:"app",children:e?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(R,{}),Object(z.jsx)(ie,{})]}):Object(z.jsx)(oe,{})})})},ue=Object(f.a)({reducer:{user:M,app:N}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(87);i.a.render(Object(z.jsx)(t.a.StrictMode,{children:Object(z.jsx)(O.a,{store:ue,children:Object(z.jsx)(de,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[88,1,2]]]);
//# sourceMappingURL=main.fe9a6e2c.chunk.js.map